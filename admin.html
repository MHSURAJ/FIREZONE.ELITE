<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<style>
    body { margin:0; font-family: Arial,sans-serif; background:#121212; color:#fff; }
    h1 { padding:20px 20px 0 20px; margin:0; }
    table { width:95%; margin:20px auto; border-collapse: collapse; }
    th, td { padding:12px; border:1px solid #444; text-align:left; }
    th { background:#1f1f1f; }
    tr:nth-child(even) { background:#1a1a1a; }
    button { padding:6px 12px; margin-right:5px; border:none; cursor:pointer; border-radius:4px; font-weight:bold; }
    .approve { background-color:#28a745; color:#fff; }
    .reject { background-color:#dc3545; color:#fff; }
    .status-approved { color:#28a745; font-weight:bold; }
    .status-rejected { color:#dc3545; font-weight:bold; }
</style>
</head>
<body>

<h1>Admin Dashboard</h1>
<p style="padding-left:20px;">Player Requests</p>

<table id="playerTable">
<thead>
<tr>
<th>Name</th>
<th>Email</th>
<th>Phone</th>
<th>Status</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<!-- Player rows injected here -->
</tbody>
</table>

<script>
// ===== CONFIG =====
// Publish Google Form responses as CSV/TSV, paste URL here
const sheetURL = "https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?output=tsv"; // replace with your sheet
// ==================

let approvals = JSON.parse(localStorage.getItem("approvals")) || {};

function renderTable(data) {
    const tbody = document.querySelector("#playerTable tbody");
    tbody.innerHTML = "";
    data.forEach(row => {
        const [name, email, phone] = row;
        const tr = document.createElement("tr");
        let statusText = approvals[email] || "Pending";
        let statusClass = statusText === "approved" ? "status-approved" :
                          statusText === "rejected" ? "status-rejected" : "";

        tr.innerHTML = `
            <td>${name}</td>
            <td>${email}</td>
            <td>${phone}</td>
            <td class="${statusClass}">${statusText}</td>
            <td>
                <button class="approve" ${statusText==="approved"?"disabled":""}>Approve</button>
                <button class="reject" ${statusText==="rejected"?"disabled":""}>Reject</button>
            </td>
        `;
        // Button Events
        tr.querySelector(".approve").addEventListener("click", ()=>{
            approvals[email] = "approved";
            localStorage.setItem("approvals", JSON.stringify(approvals));
            renderTable(data);
        });
        tr.querySelector(".reject").addEventListener("click", ()=>{
            approvals[email] = "rejected";
            localStorage.setItem("approvals", JSON.stringify(approvals));
            renderTable(data);
        });
        tbody.appendChild(tr);
    });
}

// Fetch Google Sheet Data
fetch(sheetURL)
.then(res => res.text())
.then(tsv => {
    const rows = tsv.split("\n").slice(1).filter(r => r.trim()!=="").map(r => r.split("\t"));
    renderTable(rows);
})
.catch(err => {
    console.error("Error fetching sheet:", err);
    const tbody = document.querySelector("#playerTable tbody");
    tbody.innerHTML = "<tr><td colspan='5'>Failed to load player requests.</td></tr>";
});
</script>

</body>
</html>
