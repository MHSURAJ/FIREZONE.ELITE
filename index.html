<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FireZone Elite — Dashboard</title>

  <!-- style -->
  <link rel="stylesheet" href="style.css">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Orbitron:wght@600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Floating neon menu (Valorant-like) -->
  <button id="menuBtn" class="menu-btn" aria-label="menu">☰</button>

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar">
    <div class="sidebar-top">
      <div class="logo">FZ</div>
      <div class="close" id="closeSidebar">✕</div>
    </div>
    <nav class="nav">
      <a class="nav-link" data-page="dashboard">Dashboard</a>
      <a class="nav-link" data-page="allmatches">All Matches</a>
      <a class="nav-link" data-page="played">Played Matches</a>
      <a class="nav-link" data-page="contact">Contact Us</a>
      <a class="nav-link" id="signOutBtn">Logout</a>
    </nav>
    <div class="sidebar-footer">v1.0</div>
  </aside>

  <!-- Main content -->
  <main id="main">
    <!-- LOGIN CARD (shown when not logged in) -->
    <section id="loginSection" class="center-screen">
      <div class="glass-card login-card">
        <h1 class="brand">FireZone Elite</h1>
        <p class="muted">Pro tournaments • Competitive • Fast</p>
        <button id="googleLogin" class="btn btn-primary">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="G" /> Login with Google
        </button>
      </div>
    </section>

    <!-- DASHBOARD (default visible after login) -->
    <section id="dashboard" class="page">
      <div class="page-inner">
        <h2 class="page-title">Dashboard</h2>
        <div id="playerCard" class="grid">
          <div class="glass-card small" id="playerInfo">Loading player...</div>
          <div class="glass-card small" id="playerStats">Loading stats...</div>
          <div class="glass-card small" id="quickActions">
            <button class="btn btn-ghost" onclick="showPage('allmatches')">Browse Matches</button>
            <button class="btn btn-ghost" onclick="showPage('played')">Your Played</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ALL MATCHES -->
    <section id="allmatches" class="page">
      <div class="page-inner">
        <h2 class="page-title">All Matches</h2>
        <div id="tournamentList" class="list"></div>
      </div>
    </section>

    <!-- PLAYED -->
    <section id="played" class="page">
      <div class="page-inner">
        <h2 class="page-title">Played Matches</h2>
        <div id="playedList" class="list"></div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="page">
      <div class="page-inner">
        <h2 class="page-title">Contact Us</h2>
        <div class="glass-card">
          <p>Gmail: <a href="mailto:surushannu@gmail.com">surushannu@gmail.com</a></p>
          <p class="muted">Support available 10:00 - 22:00 IST</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Firebase libs (v8 used for simplicity) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    /***********************
      IMPORTANT:
      Replace the firebaseConfig object below with your project's config.
      You can find it in Firebase Console -> Project Settings -> SDK snippet.
    ***********************/
    const firebaseConfig = {
      apiKey: "AIzaSyD66aIVOTVco6rTtpVinkl64UZGnZDgn1o",
      authDomain: "firezone-elite.firebaseapp.com",
      databaseURL: "https://firezone-elite-default-rtdb.firebaseio.com/",
      projectId: "firezone-elite",
      storageBucket: "firezone-elite.appspot.com",
      messagingSenderId: "121224317328",
      appId: "1:121224317328:web:a4d19bab51fc8076400b15"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    // UI helpers
    const menuBtn = document.getElementById('menuBtn');
    const sidebar = document.getElementById('sidebar');
    const closeSidebarBtn = document.getElementById('closeSidebar');
    const pages = document.querySelectorAll('.page');
    const loginSection = document.getElementById('loginSection');

    function toggleSidebar() {
      sidebar.classList.toggle('open');
      // blur background effect
      document.body.classList.toggle('sidebar-open');
    }
    menuBtn.addEventListener('click', toggleSidebar);
    closeSidebarBtn.addEventListener('click', toggleSidebar);

    // page switcher
    function showPage(id) {
      pages.forEach(p => p.style.display = 'none');
      document.getElementById(id).style.display = 'block';
      // close sidebar on selection (mobile-friendly)
      if (sidebar.classList.contains('open')) toggleSidebar();
    }

    // initialize page visibility
    showPage('dashboard');

    // Auth — Login with popup
    document.getElementById('googleLogin').addEventListener('click', () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).catch(err => {
        alert('Login failed: ' + err.message);
        console.error(err);
      });
    });

    // Sign out
    document.getElementById('signOutBtn').addEventListener('click', () => {
      auth.signOut();
    });

    // Sign out helper (also for menu)
    function signOutNow() { auth.signOut(); }

    // DOM nodes to update
    const playerInfo = document.getElementById('playerInfo');
    const playerStats = document.getElementById('playerStats');
    const tournamentList = document.getElementById('tournamentList');
    const playedList = document.getElementById('playedList');

    // auth state
    let currentUser = null;
    auth.onAuthStateChanged(user => {
      currentUser = user;
      if (user) {
        // hide login, show dashboard area
        loginSection.style.display = 'none';
        document.querySelectorAll('main .page').forEach(p => p.style.display = 'none');
        showPage('dashboard');

        // set player info
        playerInfo.innerHTML = `
          <h3>${user.displayName || 'Player'}</h3>
          <p class="muted">${user.email}</p>
        `;

        // load stats (example: count played)
        db.ref('users/' + user.uid + '/played').once('value').then(snap => {
          const count = snap.exists() ? snap.numChildren() : 0;
          playerStats.innerHTML = `<h3>Total Played</h3><p class="big">${count}</p>`;
        });

        // load played matches realtime
        db.ref('users/' + user.uid + '/played').on('value', snap => {
          playedList.innerHTML = '';
          if (!snap.exists()) {
            playedList.innerHTML = `<div class="card-empty">No played matches yet.</div>`;
            return;
          }
          snap.forEach(ch => {
            const data = ch.val();
            const el = document.createElement('div');
            el.className = 'glass-card small';
            el.innerHTML = `<strong>${data.match || 'Match'}</strong><div class="muted">${data.date || ''}</div>`;
            playedList.appendChild(el);
          });
        });
      } else {
        // not logged in
        loginSection.style.display = 'flex';
        // hide other pages
        document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
        // close sidebar if open
        if (sidebar.classList.contains('open')) toggleSidebar();
      }
    });

    // load tournaments (realtime)
    db.ref('tournaments').on('value', snap => {
      tournamentList.innerHTML = '';
      if (!snap.exists()) {
        tournamentList.innerHTML = `<div class="card-empty">No matches available</div>`;
        return;
      }
      snap.forEach(ch => {
        const d = ch.val();
        const card = document.createElement('div');
        card.className = 'glass-card';
        card.innerHTML = `
          <div class="t-title">${d.name || 'Match'}</div>
          <div class="t-meta">Entry ₹${d.entryFee || '0'} • ${d.date || ''} ${d.time || ''}</div>
        `;
        tournamentList.appendChild(card);
      });
    });
  </script>
</body>
</html>
